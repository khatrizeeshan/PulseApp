@using PulseApp.Helpers
@using PulseApp.Protos

@inject LeaveManager.LeaveManagerClient LeaveService

<Select TValue="int" SelectedValue="@Selected" SelectedValueChanged="@OnSelectedValueChanged">
    @if (leavePolicyTypes != null)
    {
        <SelectItem Value="0">[Choose]</SelectItem>
        @foreach (var item in leavePolicyTypes)
        {
            <SelectItem Value="@item.Id">@item.Name</SelectItem>
        }
    }
</Select>

@code {

    private LeavePolicyTypeProto[] leavePolicyTypes;

    [Parameter]
    public int Selected { get; set; }

    [Parameter]
    public EventCallback<int> SelectedChanged { get; set; }

    protected override async Task OnInitializedAsync()
    {
        await Get();
    }

    private async Task Get()
    {
        var response = await LeaveService.GetLeavePolicyTypesAsync(new EmptyRequest());
        leavePolicyTypes = response.LeavePolicyTypes.ToArray();
    }

    private async Task OnSelectedValueChanged(int value)
    {
        await this.SelectedChanged.InvokeAsync(value);
    }


}
